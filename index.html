<!DOCTYPE html>
<html>
	<head>
		<title>경북대 점심, 뭐 먹지?</title>
		<script data-ad-client="ca-pub-5536191614660236" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<style>
		.center {
			 text-align: center
		}
		</style>
	</head>
	<body>
	<div style="width: 100%; height: 50%;">
		<img id='myImg' width="100%" height="100%">
	</div>
	<div style="width: 100%; height:10%;">
		<p id='food_name' class="center" style="font-size:2.5em;"></p>
	</div>
	<div style="width:100%; height:30%;">
		<div id="map" style="width:100%;height:100%;"></div>
	</div>
	<div style="width: 100%; height:10%;">
		<center>
		<form>
			<input type="button" onClick="history.go(0)" value="다시 뽑기" style="font-size:3em; box-shadow: 0 12px 16px 0 rgba(0,0,0,0.2),0 17px 50px 0 rgba(0,0,0,0.19);">
		</form>
		</center>
	</div>

	<script src="PapaParse-5.0.2/papaparse.js"></script>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=488b379934773e65aefc9613887e9c91"></script>
	<script>
		function getData(callbackFunc){
			Papa.parse("data.csv", {
				download: true,
				header: true,
				complete: function(results) {
					callbackFunc(results.data);
					}
				}
			);
		};

		getData( function(csvdata){
			var img_cnt = csvdata.length;
			var rand_num = Math.floor(Math.random() * (img_cnt - 1));
			var img = document.getElementById("myImg");
			img.setAttribute('src',csvdata[rand_num].imgs);
			var foodname = document.getElementById('food_name');
			foodname.innerHTML = csvdata[rand_num].foodnames;

			var container = document.getElementById('map');
			var options = {
				center: new kakao.maps.LatLng(
					parseFloat(csvdata[rand_num].lat),
					parseFloat(csvdata[rand_num].lon)),
				 level: 3
			};
			var map = new kakao.maps.Map(container, options);
			var markerPosition  = new kakao.maps.LatLng(
					parseFloat(csvdata[rand_num].lat),
					parseFloat(csvdata[rand_num].lon));
			var marker = new kakao.maps.Marker({
				position: markerPosition
			});
			marker.setMap(map);
		});
	</script>
	</body>
</html>
